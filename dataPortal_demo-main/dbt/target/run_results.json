{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.4", "generated_at": "2026-02-12T00:16:59.387428Z", "invocation_id": "390854c2-5655-4c67-9393-17472f18ec59", "invocation_started_at": "2026-02-12T00:16:48.168368Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.185923Z", "completed_at": "2026-02-12T00:16:56.196205Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.205723Z", "completed_at": "2026-02-12T00:16:56.205758Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02855992317199707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_addresses", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.199155Z", "completed_at": "2026-02-12T00:16:56.201827Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.216898Z", "completed_at": "2026-02-12T00:16:56.217051Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.036890268325805664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_customers", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.202989Z", "completed_at": "2026-02-12T00:16:56.204927Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.219114Z", "completed_at": "2026-02-12T00:16:56.219141Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.036626577377319336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_order_items", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.207522Z", "completed_at": "2026-02-12T00:16:56.213069Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.222281Z", "completed_at": "2026-02-12T00:16:56.222310Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.03847360610961914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_orders", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.238012Z", "completed_at": "2026-02-12T00:16:56.240929Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.249367Z", "completed_at": "2026-02-12T00:16:56.249388Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020525693893432617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_payments", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.242918Z", "completed_at": "2026-02-12T00:16:56.245017Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.253855Z", "completed_at": "2026-02-12T00:16:56.253875Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0224912166595459, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_products", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.245924Z", "completed_at": "2026-02-12T00:16:56.248285Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.255200Z", "completed_at": "2026-02-12T00:16:56.255231Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.022498607635498047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_promotions", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.250759Z", "completed_at": "2026-02-12T00:16:56.252889Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.257746Z", "completed_at": "2026-02-12T00:16:56.257767Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.022655725479125977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_reviews", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.270087Z", "completed_at": "2026-02-12T00:16:56.272858Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.284183Z", "completed_at": "2026-02-12T00:16:56.284207Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02277541160583496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_supply_costs", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.285393Z", "completed_at": "2026-02-12T00:16:56.298810Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.306172Z", "completed_at": "2026-02-12T00:16:56.306198Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.03878283500671387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_order_items", "compiled": true, "compiled_code": "with source as (\n    select * from ANALYTICS.STAGING.raw_order_items\n),\n\nrenamed as (\n    select\n        id as order_item_id,\n        order_id,\n        product_id,\n        quantity,\n        unit_price_cents / 100.0 as unit_price,\n        quantity * (unit_price_cents / 100.0) as line_total\n    from source\n)\n\nselect * from renamed", "relation_name": "ANALYTICS.STAGING.stg_order_items", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.275000Z", "completed_at": "2026-02-12T00:16:56.305157Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.308850Z", "completed_at": "2026-02-12T00:16:56.308886Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04448866844177246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_addresses", "compiled": true, "compiled_code": "with source as (\n    select * from ANALYTICS.STAGING.raw_addresses\n),\n\nrenamed as (\n    select\n        id as address_id,\n        customer_id,\n        address_type,\n        city,\n        state,\n        zip_code,\n        case when is_primary = 1 then true else false end as is_primary\n    from source\n)\n\nselect * from renamed", "relation_name": "ANALYTICS.STAGING.stg_addresses", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.279501Z", "completed_at": "2026-02-12T00:16:56.307573Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.313289Z", "completed_at": "2026-02-12T00:16:56.313329Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04794025421142578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_customers", "compiled": true, "compiled_code": "with source as (\n    select * from ANALYTICS.STAGING.raw_customers\n\n),\n\nrenamed as (\n\n    select\n        id as customer_id,\n        first_name,\n        last_name\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "ANALYTICS.STAGING.stg_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.300160Z", "completed_at": "2026-02-12T00:16:56.311628Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.317809Z", "completed_at": "2026-02-12T00:16:56.317826Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021875858306884766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_orders", "compiled": true, "compiled_code": "with source as (\n    select * from ANALYTICS.STAGING.raw_orders\n\n),\n\nrenamed as (\n\n    select\n        id as order_id,\n        user_id as customer_id,\n        order_date,\n        status\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "ANALYTICS.STAGING.stg_orders", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.325740Z", "completed_at": "2026-02-12T00:16:56.342272Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.356298Z", "completed_at": "2026-02-12T00:16:56.356324Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.039781808853149414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_payments", "compiled": true, "compiled_code": "with source as (\n    select * from ANALYTICS.STAGING.raw_payments\n\n),\n\nrenamed as (\n\n    select\n        id as payment_id,\n        order_id,\n        payment_method,\n\n        -- `amount` is currently stored in cents, so we convert it to dollars\n        amount / 100 as amount\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "ANALYTICS.STAGING.stg_payments", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.333216Z", "completed_at": "2026-02-12T00:16:56.355370Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.360021Z", "completed_at": "2026-02-12T00:16:56.360049Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.039862632751464844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_products", "compiled": true, "compiled_code": "with source as (\n    select * from ANALYTICS.STAGING.raw_products\n),\n\nrenamed as (\n    select\n        id as product_id,\n        name as product_name,\n        category as product_category,\n        unit_price_cents / 100.0 as unit_price,\n        created_at\n    from source\n)\n\nselect * from renamed", "relation_name": "ANALYTICS.STAGING.stg_products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.343276Z", "completed_at": "2026-02-12T00:16:56.357939Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.362738Z", "completed_at": "2026-02-12T00:16:56.362757Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03890109062194824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_promotions", "compiled": true, "compiled_code": "with source as (\n    select * from ANALYTICS.STAGING.raw_promotions\n),\n\nrenamed as (\n    select\n        id as promotion_id,\n        promotion_code,\n        discount_pct,\n        valid_from,\n        valid_to,\n        min_order_cents / 100.0 as min_order_amount\n    from source\n)\n\nselect * from renamed", "relation_name": "ANALYTICS.STAGING.stg_promotions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.350066Z", "completed_at": "2026-02-12T00:16:56.359156Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.364846Z", "completed_at": "2026-02-12T00:16:56.364873Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.033843994140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_reviews", "compiled": true, "compiled_code": "with source as (\n    select * from ANALYTICS.STAGING.raw_reviews\n),\n\nrenamed as (\n    select\n        id as review_id,\n        product_id,\n        customer_id,\n        order_id,\n        rating,\n        review_text,\n        created_at as reviewed_at\n    from source\n)\n\nselect * from renamed", "relation_name": "ANALYTICS.STAGING.stg_reviews", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.376356Z", "completed_at": "2026-02-12T00:16:56.419869Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.439512Z", "completed_at": "2026-02-12T00:16:56.439598Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07285523414611816, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_supply_costs", "compiled": true, "compiled_code": "with source as (\n    select * from ANALYTICS.STAGING.raw_supply_costs\n),\n\nrenamed as (\n    select\n        id as supply_cost_id,\n        product_id,\n        cost_cents / 100.0 as supply_cost,\n        effective_from,\n        effective_to\n    from source\n)\n\nselect * from renamed", "relation_name": "ANALYTICS.STAGING.stg_supply_costs", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.382666Z", "completed_at": "2026-02-12T00:16:56.469869Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.478691Z", "completed_at": "2026-02-12T00:16:56.478757Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.10808539390563965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_item_id\nfrom ANALYTICS.STAGING.stg_order_items\nwhere order_item_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.408145Z", "completed_at": "2026-02-12T00:16:56.472693Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.481457Z", "completed_at": "2026-02-12T00:16:56.481504Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.10825681686401367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_item_id as unique_field,\n    count(*) as n_records\n\nfrom ANALYTICS.STAGING.stg_order_items\nwhere order_item_id is not null\ngroup by order_item_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.421779Z", "completed_at": "2026-02-12T00:16:56.477040Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.499901Z", "completed_at": "2026-02-12T00:16:56.499945Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.12577009201049805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.int_customer_addresses", "compiled": true, "compiled_code": "-- Gets primary shipping address per customer\nwith addresses as (\n    select * from ANALYTICS.STAGING.stg_addresses\n),\n\nfinal as (\n    select\n        customer_id,\n        city,\n        state,\n        zip_code,\n        address_type\n    from addresses\n    where is_primary = true and address_type = 'shipping'\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.int_customer_addresses", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.484931Z", "completed_at": "2026-02-12T00:16:56.511784Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.520244Z", "completed_at": "2026-02-12T00:16:56.520287Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.0543370246887207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_addresses_address_id.eabbd5d501", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect address_id\nfrom ANALYTICS.STAGING.stg_addresses\nwhere address_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.526695Z", "completed_at": "2026-02-12T00:16:56.567932Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.572214Z", "completed_at": "2026-02-12T00:16:56.572240Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06249809265136719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_addresses_address_id.d15360bb00", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    address_id as unique_field,\n    count(*) as n_records\n\nfrom ANALYTICS.STAGING.stg_addresses\nwhere address_id is not null\ngroup by address_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.543019Z", "completed_at": "2026-02-12T00:16:56.569448Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.574299Z", "completed_at": "2026-02-12T00:16:56.574319Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06104898452758789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom ANALYTICS.STAGING.stg_customers\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.552958Z", "completed_at": "2026-02-12T00:16:56.573424Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.582149Z", "completed_at": "2026-02-12T00:16:56.582177Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06671476364135742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom ANALYTICS.STAGING.stg_customers\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.575726Z", "completed_at": "2026-02-12T00:16:56.590530Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.603671Z", "completed_at": "2026-02-12T00:16:56.603707Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.038254737854003906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.dim_dates", "compiled": true, "compiled_code": "-- Date dimension derived from order dates\nwith order_dates as (\n    select distinct order_date\n    from ANALYTICS.STAGING.stg_orders\n),\n\nfinal as (\n    select\n        order_date as date_day,\n        extract(year from order_date) as year_number,\n        extract(month from order_date) as month_number,\n        to_char(order_date, 'MMMM') as month_name,\n        extract(week from order_date) as week_number,\n        dayofweek(order_date) as day_of_week,\n        dayname(order_date) as day_name,\n        case when dayofweek(order_date) in (0, 6) then true else false end as is_weekend,\n        date_trunc('month', order_date) as first_day_of_month,\n        extract(quarter from order_date) as quarter_number\n    from order_dates\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.dim_dates", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.593699Z", "completed_at": "2026-02-12T00:16:56.617602Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.630318Z", "completed_at": "2026-02-12T00:16:56.630354Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.045168161392211914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from ANALYTICS.STAGING.stg_orders\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'placed','shipped','completed','return_pending','returned'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.606180Z", "completed_at": "2026-02-12T00:16:56.629123Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.634485Z", "completed_at": "2026-02-12T00:16:56.634519Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.046182870864868164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom ANALYTICS.STAGING.stg_orders\nwhere order_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.619325Z", "completed_at": "2026-02-12T00:16:56.636112Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.645513Z", "completed_at": "2026-02-12T00:16:56.645564Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05414938926696777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom ANALYTICS.STAGING.stg_orders\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.638220Z", "completed_at": "2026-02-12T00:16:56.649320Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.653661Z", "completed_at": "2026-02-12T00:16:56.653683Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.025847911834716797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.customers", "compiled": true, "compiled_code": "with customers as (\n\n    select * from ANALYTICS.STAGING.stg_customers\n\n),\n\norders as (\n\n    select * from ANALYTICS.STAGING.stg_orders\n\n),\n\npayments as (\n\n    select * from ANALYTICS.STAGING.stg_payments\n\n),\n\ncustomer_orders as (\n\n        select\n        customer_id,\n\n        min(order_date) as first_order,\n        max(order_date) as most_recent_order,\n        count(order_id) as number_of_orders\n    from orders\n\n    group by customer_id\n\n),\n\ncustomer_payments as (\n\n    select\n        orders.customer_id,\n        sum(amount) as total_amount\n\n    from payments\n\n    left join orders on\n         payments.order_id = orders.order_id\n\n    group by orders.customer_id\n\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order,\n        customer_orders.most_recent_order,\n        customer_orders.number_of_orders,\n        customer_payments.total_amount as customer_lifetime_value\n\n    from customers\n\n    left join customer_orders\n        on customers.customer_id = customer_orders.customer_id\n\n    left join customer_payments\n        on  customers.customer_id = customer_payments.customer_id\n\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.661261Z", "completed_at": "2026-02-12T00:16:56.671744Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.681545Z", "completed_at": "2026-02-12T00:16:56.681571Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03349757194519043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.int_payment_method_analysis", "compiled": true, "compiled_code": "-- Analyzes payment methods across orders\nwith payments as (\n    select * from ANALYTICS.STAGING.stg_payments\n),\n\norders as (\n    select * from ANALYTICS.STAGING.stg_orders\n),\n\nfinal as (\n    select\n        p.payment_method,\n        date_trunc('month', o.order_date) as order_month,\n        count(distinct p.payment_id) as transaction_count,\n        count(distinct p.order_id) as order_count,\n        sum(p.amount) as total_amount,\n        avg(p.amount) as avg_amount,\n        min(p.amount) as min_amount,\n        max(p.amount) as max_amount\n    from payments p\n    left join orders o on p.order_id = o.order_id\n    group by p.payment_method, date_trunc('month', o.order_date)\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.int_payment_method_analysis", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.655808Z", "completed_at": "2026-02-12T00:16:56.678678Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.683366Z", "completed_at": "2026-02-12T00:16:56.683391Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03673958778381348, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.int_order_payments_pivoted", "compiled": true, "compiled_code": "-- Pivots payments by method for each order\n\n\nwith payments as (\n    select * from ANALYTICS.STAGING.stg_payments\n),\n\nfinal as (\n    select\n        order_id,\n        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,\n        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,\n        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,\n        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,\n        sum(amount) as total_payment_amount,\n        count(*) as payment_count\n    from payments\n    group by order_id\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.int_order_payments_pivoted", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.672933Z", "completed_at": "2026-02-12T00:16:56.690591Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.698529Z", "completed_at": "2026-02-12T00:16:56.698573Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04406094551086426, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.orders", "compiled": true, "compiled_code": "\n\nwith orders as (\n\n    select * from ANALYTICS.STAGING.stg_orders\n\n),\n\npayments as (\n\n    select * from ANALYTICS.STAGING.stg_payments\n\n),\n\norder_payments as (\n\n    select\n        order_id,\n\n        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,\n        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,\n        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,\n        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,\n        sum(amount) as total_amount\n\n    from payments\n\n    group by order_id\n\n),\n\nfinal as (\n\n    select\n        orders.order_id,\n        orders.customer_id,\n        orders.order_date,\n        orders.status,\n\n        order_payments.credit_card_amount,\n\n        order_payments.coupon_amount,\n\n        order_payments.bank_transfer_amount,\n\n        order_payments.gift_card_amount,\n\n        order_payments.total_amount as amount\n\n    from orders\n\n\n    left join order_payments\n        on orders.order_id = order_payments.order_id\n\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.orders", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.685056Z", "completed_at": "2026-02-12T00:16:56.703351Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.708884Z", "completed_at": "2026-02-12T00:16:56.708910Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.0384523868560791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        payment_method as value_field,\n        count(*) as n_records\n\n    from ANALYTICS.STAGING.stg_payments\n    group by payment_method\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'credit_card','coupon','bank_transfer','gift_card'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.712018Z", "completed_at": "2026-02-12T00:16:56.737731Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.747199Z", "completed_at": "2026-02-12T00:16:56.747237Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04640364646911621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_id\nfrom ANALYTICS.STAGING.stg_payments\nwhere payment_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.723120Z", "completed_at": "2026-02-12T00:16:56.738997Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.748696Z", "completed_at": "2026-02-12T00:16:56.748728Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04665732383728027, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_payments_payment_id.3744510712", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    payment_id as unique_field,\n    count(*) as n_records\n\nfrom ANALYTICS.STAGING.stg_payments\nwhere payment_id is not null\ngroup by payment_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.741783Z", "completed_at": "2026-02-12T00:16:56.753127Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.763751Z", "completed_at": "2026-02-12T00:16:56.763793Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.053412675857543945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.int_order_items_with_products", "compiled": true, "compiled_code": "-- Enriches order items with product details\nwith order_items as (\n    select * from ANALYTICS.STAGING.stg_order_items\n),\n\nproducts as (\n    select * from ANALYTICS.STAGING.stg_products\n),\n\nfinal as (\n    select\n        oi.order_item_id,\n        oi.order_id,\n        oi.product_id,\n        p.product_name,\n        p.product_category,\n        oi.quantity,\n        oi.unit_price,\n        oi.line_total\n    from order_items oi\n    left join products p on oi.product_id = p.product_id\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.int_order_items_with_products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.755364Z", "completed_at": "2026-02-12T00:16:56.768872Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.779705Z", "completed_at": "2026-02-12T00:16:56.779752Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.04000711441040039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.accepted_values_stg_products_product_category__Food__Beverage__Merchandise__Gift.1a1609a3ac", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        product_category as value_field,\n        count(*) as n_records\n\n    from ANALYTICS.STAGING.stg_products\n    group by product_category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Food','Beverage','Merchandise','Gift'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.770879Z", "completed_at": "2026-02-12T00:16:56.791652Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.801968Z", "completed_at": "2026-02-12T00:16:56.801991Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03984785079956055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom ANALYTICS.STAGING.stg_products\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.781639Z", "completed_at": "2026-02-12T00:16:56.792735Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.803526Z", "completed_at": "2026-02-12T00:16:56.803553Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03803658485412598, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_products_product_id.7d950a1467", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom ANALYTICS.STAGING.stg_products\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.793412Z", "completed_at": "2026-02-12T00:16:56.806193Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.816781Z", "completed_at": "2026-02-12T00:16:56.816808Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03882431983947754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_promotions_promotion_id.5aebcacc6f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect promotion_id\nfrom ANALYTICS.STAGING.stg_promotions\nwhere promotion_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.809552Z", "completed_at": "2026-02-12T00:16:56.822302Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.830096Z", "completed_at": "2026-02-12T00:16:56.830122Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.029404163360595703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_promotions_promotion_id.9a213e3ecb", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    promotion_id as unique_field,\n    count(*) as n_records\n\nfrom ANALYTICS.STAGING.stg_promotions\nwhere promotion_id is not null\ngroup by promotion_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.824946Z", "completed_at": "2026-02-12T00:16:56.842260Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.859040Z", "completed_at": "2026-02-12T00:16:56.859106Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04134631156921387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.int_product_reviews_agg", "compiled": true, "compiled_code": "-- Aggregated review metrics per product\nwith reviews as (\n    select * from ANALYTICS.STAGING.stg_reviews\n),\n\nfinal as (\n    select\n        product_id,\n        count(review_id) as review_count,\n        avg(rating) as avg_rating,\n        min(rating) as min_rating,\n        max(rating) as max_rating,\n        sum(case when rating >= 4 then 1 else 0 end) as positive_reviews,\n        sum(case when rating <= 2 then 1 else 0 end) as negative_reviews\n    from reviews\n    group by product_id\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.int_product_reviews_agg", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.831509Z", "completed_at": "2026-02-12T00:16:56.849094Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.861188Z", "completed_at": "2026-02-12T00:16:56.861212Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04261207580566406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_reviews_review_id.943b8fc3e4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect review_id\nfrom ANALYTICS.STAGING.stg_reviews\nwhere review_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.843559Z", "completed_at": "2026-02-12T00:16:56.865061Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.879117Z", "completed_at": "2026-02-12T00:16:56.879161Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0554203987121582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_reviews_review_id.9b6c259f3c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    review_id as unique_field,\n    count(*) as n_records\n\nfrom ANALYTICS.STAGING.stg_reviews\nwhere review_id is not null\ngroup by review_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.868561Z", "completed_at": "2026-02-12T00:16:56.884230Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.894080Z", "completed_at": "2026-02-12T00:16:56.894103Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.0368344783782959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_supply_costs_supply_cost_id.635c51159d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect supply_cost_id\nfrom ANALYTICS.STAGING.stg_supply_costs\nwhere supply_cost_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.887183Z", "completed_at": "2026-02-12T00:16:56.906570Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.917944Z", "completed_at": "2026-02-12T00:16:56.917974Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.040170907974243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_supply_costs_supply_cost_id.c295b12b05", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    supply_cost_id as unique_field,\n    count(*) as n_records\n\nfrom ANALYTICS.STAGING.stg_supply_costs\nwhere supply_cost_id is not null\ngroup by supply_cost_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.896492Z", "completed_at": "2026-02-12T00:16:56.916914Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.920264Z", "completed_at": "2026-02-12T00:16:56.920288Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03919649124145508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_dim_dates_date_day.1717af99fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom ANALYTICS.STAGING.dim_dates\nwhere date_day is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.909412Z", "completed_at": "2026-02-12T00:16:56.921376Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.932348Z", "completed_at": "2026-02-12T00:16:56.932382Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03703594207763672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_dim_dates_date_day.5e9dfa95c7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_day as unique_field,\n    count(*) as n_records\n\nfrom ANALYTICS.STAGING.dim_dates\nwhere date_day is not null\ngroup by date_day\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.923105Z", "completed_at": "2026-02-12T00:16:56.938574Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.949135Z", "completed_at": "2026-02-12T00:16:56.949162Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.041625261306762695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom ANALYTICS.STAGING.customers\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.941443Z", "completed_at": "2026-02-12T00:16:56.957723Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.969277Z", "completed_at": "2026-02-12T00:16:56.969308Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0355226993560791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom ANALYTICS.STAGING.customers\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.950380Z", "completed_at": "2026-02-12T00:16:56.968310Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.973715Z", "completed_at": "2026-02-12T00:16:56.973740Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.038480281829833984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.finance_payment_mix", "compiled": true, "compiled_code": "-- Payment method distribution analysis\nwith payments as (\n    select * from ANALYTICS.STAGING.int_payment_method_analysis\n),\n\ntotals as (\n    select\n        order_month,\n        sum(total_amount) as month_total\n    from payments\n    group by order_month\n),\n\nfinal as (\n    select\n        p.payment_method,\n        p.order_month,\n        p.transaction_count,\n        p.order_count,\n        p.total_amount,\n        p.avg_amount,\n        case when t.month_total > 0\n            then p.total_amount / t.month_total * 100\n            else 0\n        end as pct_of_monthly_revenue\n    from payments p\n    left join totals t on p.order_month = t.order_month\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.finance_payment_mix", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.958966Z", "completed_at": "2026-02-12T00:16:56.972638Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.984471Z", "completed_at": "2026-02-12T00:16:56.984505Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04455089569091797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from ANALYTICS.STAGING.orders\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'placed','shipped','completed','return_pending','returned'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.976066Z", "completed_at": "2026-02-12T00:16:56.991523Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:56.994751Z", "completed_at": "2026-02-12T00:16:56.994772Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.027531147003173828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_orders_amount.106140f9fd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect amount\nfrom ANALYTICS.STAGING.orders\nwhere amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.008750Z", "completed_at": "2026-02-12T00:16:57.029296Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.032314Z", "completed_at": "2026-02-12T00:16:57.032365Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04199337959289551, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect coupon_amount\nfrom ANALYTICS.STAGING.orders\nwhere coupon_amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:56.996218Z", "completed_at": "2026-02-12T00:16:57.030359Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.036037Z", "completed_at": "2026-02-12T00:16:57.036066Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04880166053771973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect bank_transfer_amount\nfrom ANALYTICS.STAGING.orders\nwhere bank_transfer_amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.018672Z", "completed_at": "2026-02-12T00:16:57.034319Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.047769Z", "completed_at": "2026-02-12T00:16:57.047823Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05487060546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect credit_card_amount\nfrom ANALYTICS.STAGING.orders\nwhere credit_card_amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.038652Z", "completed_at": "2026-02-12T00:16:57.053487Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.058212Z", "completed_at": "2026-02-12T00:16:57.058251Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.030559301376342773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_orders_customer_id.c5f02694af", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom ANALYTICS.STAGING.orders\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.061564Z", "completed_at": "2026-02-12T00:16:57.093646Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.097885Z", "completed_at": "2026-02-12T00:16:57.097912Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04666399955749512, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect gift_card_amount\nfrom ANALYTICS.STAGING.orders\nwhere gift_card_amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.075145Z", "completed_at": "2026-02-12T00:16:57.096845Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.100711Z", "completed_at": "2026-02-12T00:16:57.100734Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04554247856140137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_orders_order_id.cf6c17daed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom ANALYTICS.STAGING.orders\nwhere order_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.084513Z", "completed_at": "2026-02-12T00:16:57.099175Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.103822Z", "completed_at": "2026-02-12T00:16:57.103848Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04693484306335449, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from ANALYTICS.STAGING.orders\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from ANALYTICS.STAGING.customers\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.105452Z", "completed_at": "2026-02-12T00:16:57.117593Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.121236Z", "completed_at": "2026-02-12T00:16:57.121257Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.026623249053955078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_orders_order_id.fed79b3a6e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom ANALYTICS.STAGING.orders\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.122579Z", "completed_at": "2026-02-12T00:16:57.136574Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.145867Z", "completed_at": "2026-02-12T00:16:57.145894Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0321962833404541, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.fct_order_items", "compiled": true, "compiled_code": "-- Fact table at the line-item grain\nwith items as (\n    select * from ANALYTICS.STAGING.int_order_items_with_products\n),\n\norders as (\n    select * from ANALYTICS.STAGING.stg_orders\n),\n\nsupply as (\n    select * from ANALYTICS.STAGING.stg_supply_costs\n),\n\nfinal as (\n    select\n        i.order_item_id,\n        i.order_id,\n        o.customer_id,\n        o.order_date,\n        o.status as order_status,\n        i.product_id,\n        i.product_name,\n        i.product_category,\n        i.quantity,\n        i.unit_price,\n        i.line_total,\n        s.supply_cost,\n        i.quantity * s.supply_cost as line_cost,\n        i.line_total - (i.quantity * s.supply_cost) as line_profit\n    from items i\n    left join orders o on i.order_id = o.order_id\n    left join supply s on i.product_id = s.product_id\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.fct_order_items", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.129610Z", "completed_at": "2026-02-12T00:16:57.147610Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.151583Z", "completed_at": "2026-02-12T00:16:57.151608Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.035361289978027344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.int_category_performance", "compiled": true, "compiled_code": "-- Product category performance metrics\nwith items as (\n    select * from ANALYTICS.STAGING.int_order_items_with_products\n),\n\norders as (\n    select * from ANALYTICS.STAGING.stg_orders\n),\n\nfinal as (\n    select\n        i.product_category,\n        date_trunc('month', o.order_date) as order_month,\n        count(distinct i.order_id) as order_count,\n        sum(i.quantity) as units_sold,\n        sum(i.line_total) as category_revenue,\n        count(distinct o.customer_id) as unique_customers,\n        avg(i.line_total) as avg_line_value\n    from items i\n    left join orders o on i.order_id = o.order_id\n    group by i.product_category, date_trunc('month', o.order_date)\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.int_category_performance", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.137507Z", "completed_at": "2026-02-12T00:16:57.150250Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.163168Z", "completed_at": "2026-02-12T00:16:57.163201Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04369401931762695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.int_order_totals", "compiled": true, "compiled_code": "-- Aggregates order-level totals from line items\nwith order_items as (\n    select * from ANALYTICS.STAGING.int_order_items_with_products\n),\n\nfinal as (\n    select\n        order_id,\n        count(distinct order_item_id) as total_items,\n        sum(quantity) as total_quantity,\n        sum(line_total) as items_subtotal,\n        count(distinct product_category) as distinct_categories\n    from order_items\n    group by order_id\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.int_order_totals", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.156251Z", "completed_at": "2026-02-12T00:16:57.171880Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.176885Z", "completed_at": "2026-02-12T00:16:57.176911Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.03266453742980957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.int_product_order_summary", "compiled": true, "compiled_code": "-- Summary of each product across all orders\nwith order_items as (\n    select * from ANALYTICS.STAGING.int_order_items_with_products\n),\n\norders as (\n    select * from ANALYTICS.STAGING.stg_orders\n),\n\nfinal as (\n    select\n        oi.product_id,\n        oi.product_name,\n        oi.product_category,\n        count(distinct oi.order_id) as times_ordered,\n        sum(oi.quantity) as total_units_sold,\n        sum(oi.line_total) as total_revenue,\n        avg(oi.line_total) as avg_line_total,\n        count(distinct o.customer_id) as unique_customers\n    from order_items oi\n    left join orders o on oi.order_id = o.order_id\n    group by oi.product_id, oi.product_name, oi.product_category\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.int_product_order_summary", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.178139Z", "completed_at": "2026-02-12T00:16:57.203264Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.208256Z", "completed_at": "2026-02-12T00:16:57.208291Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04218935966491699, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_fct_order_items_order_item_id.dbaab21f55", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_item_id\nfrom ANALYTICS.STAGING.fct_order_items\nwhere order_item_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.186351Z", "completed_at": "2026-02-12T00:16:57.204698Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.210024Z", "completed_at": "2026-02-12T00:16:57.210042Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03908896446228027, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_fct_order_items_order_item_id.0dec5f6768", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_item_id as unique_field,\n    count(*) as n_records\n\nfrom ANALYTICS.STAGING.fct_order_items\nwhere order_item_id is not null\ngroup by order_item_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.195617Z", "completed_at": "2026-02-12T00:16:57.213185Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.224704Z", "completed_at": "2026-02-12T00:16:57.224798Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05177736282348633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.ops_category_mix", "compiled": true, "compiled_code": "-- Category mix analysis for operations planning\nwith category_perf as (\n    select * from ANALYTICS.STAGING.int_category_performance\n),\n\nmonthly_totals as (\n    select\n        order_month,\n        sum(category_revenue) as total_monthly_revenue,\n        sum(units_sold) as total_monthly_units\n    from category_perf\n    group by order_month\n),\n\nfinal as (\n    select\n        cp.product_category,\n        cp.order_month,\n        cp.order_count,\n        cp.units_sold,\n        cp.category_revenue,\n        cp.unique_customers,\n        cp.avg_line_value,\n        mt.total_monthly_revenue,\n        case when mt.total_monthly_revenue > 0\n            then cp.category_revenue / mt.total_monthly_revenue * 100\n            else 0\n        end as revenue_share_pct,\n        case when mt.total_monthly_units > 0\n            then cp.units_sold * 1.0 / mt.total_monthly_units * 100\n            else 0\n        end as volume_share_pct\n    from category_perf cp\n    left join monthly_totals mt on cp.order_month = mt.order_month\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.ops_category_mix", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.214754Z", "completed_at": "2026-02-12T00:16:57.229244Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.239136Z", "completed_at": "2026-02-12T00:16:57.239185Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.03374052047729492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.int_orders_enriched", "compiled": true, "compiled_code": "-- Combines orders with payment and item details\nwith orders as (\n    select * from ANALYTICS.STAGING.stg_orders\n),\n\norder_totals as (\n    select * from ANALYTICS.STAGING.int_order_totals\n),\n\norder_payments as (\n    select * from ANALYTICS.STAGING.int_order_payments_pivoted\n),\n\nfinal as (\n    select\n        o.order_id,\n        o.customer_id,\n        o.order_date,\n        o.status,\n        ot.total_items,\n        ot.total_quantity,\n        ot.items_subtotal,\n        ot.distinct_categories,\n        op.credit_card_amount,\n        op.coupon_amount,\n        op.bank_transfer_amount,\n        op.gift_card_amount,\n        op.total_payment_amount,\n        op.payment_count,\n        case\n            when o.status = 'completed' then true\n            else false\n        end as is_completed,\n        case\n            when o.status in ('returned', 'return_pending') then true\n            else false\n        end as is_returned\n    from orders o\n    left join order_totals ot on o.order_id = ot.order_id\n    left join order_payments op on o.order_id = op.order_id\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.int_orders_enriched", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.230626Z", "completed_at": "2026-02-12T00:16:57.242470Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.243335Z", "completed_at": "2026-02-12T00:16:57.243352Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.020763397216796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.int_product_profitability", "compiled": true, "compiled_code": "-- Calculates margin per product\nwith product_orders as (\n    select * from ANALYTICS.STAGING.int_product_order_summary\n),\n\nsupply_costs as (\n    select * from ANALYTICS.STAGING.stg_supply_costs\n),\n\nproducts as (\n    select * from ANALYTICS.STAGING.stg_products\n),\n\nfinal as (\n    select\n        po.product_id,\n        po.product_name,\n        po.product_category,\n        p.unit_price,\n        sc.supply_cost,\n        p.unit_price - sc.supply_cost as unit_margin,\n        case when p.unit_price > 0\n            then (p.unit_price - sc.supply_cost) / p.unit_price * 100\n            else 0\n        end as margin_pct,\n        po.total_units_sold,\n        po.total_revenue,\n        po.total_units_sold * sc.supply_cost as total_cost,\n        po.total_revenue - (po.total_units_sold * sc.supply_cost) as gross_profit\n    from product_orders po\n    left join supply_costs sc on po.product_id = sc.product_id\n    left join products p on po.product_id = p.product_id\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.int_product_profitability", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.255427Z", "completed_at": "2026-02-12T00:16:57.280157Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.285026Z", "completed_at": "2026-02-12T00:16:57.285048Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.037008047103881836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.dim_products", "compiled": true, "compiled_code": "-- Core product dimension with reviews and profitability\nwith products as (\n    select * from ANALYTICS.STAGING.stg_products\n),\n\nreviews as (\n    select * from ANALYTICS.STAGING.int_product_reviews_agg\n),\n\nprofitability as (\n    select * from ANALYTICS.STAGING.int_product_profitability\n),\n\nfinal as (\n    select\n        p.product_id,\n        p.product_name,\n        p.product_category,\n        p.unit_price,\n        pr.supply_cost,\n        pr.unit_margin,\n        pr.margin_pct,\n        r.review_count,\n        r.avg_rating,\n        r.positive_reviews,\n        r.negative_reviews,\n        case\n            when r.avg_rating >= 4.5 then 'Excellent'\n            when r.avg_rating >= 3.5 then 'Good'\n            when r.avg_rating >= 2.5 then 'Average'\n            else 'Poor'\n        end as rating_tier,\n        pr.total_units_sold,\n        pr.total_revenue as product_total_revenue,\n        pr.gross_profit as product_gross_profit,\n        p.created_at\n    from products p\n    left join reviews r on p.product_id = r.product_id\n    left join profitability pr on p.product_id = pr.product_id\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.dim_products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.269464Z", "completed_at": "2026-02-12T00:16:57.282661Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.286152Z", "completed_at": "2026-02-12T00:16:57.286178Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.033730506896972656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.finance_product_margins", "compiled": true, "compiled_code": "-- Product-level margin analysis for finance\nwith profitability as (\n    select * from ANALYTICS.STAGING.int_product_profitability\n),\n\nreviews as (\n    select * from ANALYTICS.STAGING.int_product_reviews_agg\n),\n\nfinal as (\n    select\n        p.product_id,\n        p.product_name,\n        p.product_category,\n        p.unit_price,\n        p.supply_cost,\n        p.unit_margin,\n        p.margin_pct,\n        p.total_units_sold,\n        p.total_revenue,\n        p.total_cost,\n        p.gross_profit,\n        r.avg_rating,\n        r.review_count,\n        case\n            when p.margin_pct >= 50 then 'High Margin'\n            when p.margin_pct >= 30 then 'Medium Margin'\n            else 'Low Margin'\n        end as margin_category\n    from profitability p\n    left join reviews r on p.product_id = r.product_id\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.finance_product_margins", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.263743Z", "completed_at": "2026-02-12T00:16:57.283712Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.288231Z", "completed_at": "2026-02-12T00:16:57.288253Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.037281036376953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.fct_orders", "compiled": true, "compiled_code": "-- Core fact table for orders with all enrichments\nwith orders as (\n    select * from ANALYTICS.STAGING.int_orders_enriched\n),\n\ncustomers as (\n    select * from ANALYTICS.STAGING.stg_customers\n),\n\nfinal as (\n    select\n        o.order_id,\n        o.customer_id,\n        c.first_name || ' ' || c.last_name as customer_name,\n        o.order_date,\n        o.status,\n        o.is_completed,\n        o.is_returned,\n        o.total_items,\n        o.total_quantity,\n        o.items_subtotal,\n        o.distinct_categories,\n        o.credit_card_amount,\n        o.coupon_amount,\n        o.bank_transfer_amount,\n        o.gift_card_amount,\n        o.total_payment_amount,\n        o.payment_count,\n        case\n            when o.total_payment_amount >= 50 then 'Large'\n            when o.total_payment_amount >= 20 then 'Medium'\n            else 'Small'\n        end as order_size_bucket\n    from orders o\n    left join customers c on o.customer_id = c.customer_id\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.fct_orders", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.275297Z", "completed_at": "2026-02-12T00:16:57.289565Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.293542Z", "completed_at": "2026-02-12T00:16:57.293561Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0403134822845459, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.int_customer_order_history", "compiled": true, "compiled_code": "-- Builds per-customer order aggregation\nwith orders as (\n    select * from ANALYTICS.STAGING.int_orders_enriched\n),\n\nfinal as (\n    select\n        customer_id,\n        count(order_id) as lifetime_orders,\n        sum(case when is_completed then 1 else 0 end) as completed_orders,\n        sum(case when is_returned then 1 else 0 end) as returned_orders,\n        min(order_date) as first_order_date,\n        max(order_date) as last_order_date,\n        sum(total_payment_amount) as lifetime_spend,\n        avg(total_payment_amount) as avg_order_value,\n        sum(total_quantity) as lifetime_items_purchased,\n        max(total_payment_amount) as largest_order_amount\n    from orders\n    group by customer_id\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.int_customer_order_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.305513Z", "completed_at": "2026-02-12T00:16:57.332960Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.343186Z", "completed_at": "2026-02-12T00:16:57.343234Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0464019775390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.int_daily_orders", "compiled": true, "compiled_code": "-- Daily order aggregation\nwith orders as (\n    select * from ANALYTICS.STAGING.int_orders_enriched\n),\n\nfinal as (\n    select\n        order_date,\n        count(order_id) as order_count,\n        sum(total_payment_amount) as daily_revenue,\n        avg(total_payment_amount) as avg_order_value,\n        sum(total_quantity) as items_sold,\n        count(distinct customer_id) as unique_customers,\n        sum(case when is_completed then 1 else 0 end) as completed_count,\n        sum(case when is_returned then 1 else 0 end) as returned_count\n    from orders\n    group by order_date\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.int_daily_orders", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.317158Z", "completed_at": "2026-02-12T00:16:57.345171Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.348858Z", "completed_at": "2026-02-12T00:16:57.348876Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.05090689659118652, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.marketing_product_popularity", "compiled": true, "compiled_code": "-- Product popularity for marketing campaigns\nwith products as (\n    select * from ANALYTICS.STAGING.dim_products\n),\n\ncategory_perf as (\n    select * from ANALYTICS.STAGING.int_category_performance\n),\n\ncat_totals as (\n    select\n        product_category,\n        sum(units_sold) as cat_total_units,\n        sum(category_revenue) as cat_total_revenue\n    from category_perf\n    group by product_category\n),\n\nfinal as (\n    select\n        p.product_id,\n        p.product_name,\n        p.product_category,\n        p.unit_price,\n        p.avg_rating,\n        p.rating_tier,\n        p.review_count,\n        p.total_units_sold,\n        p.product_total_revenue,\n        ct.cat_total_units as category_total_units,\n        case when ct.cat_total_units > 0\n            then p.total_units_sold * 1.0 / ct.cat_total_units * 100\n            else 0\n        end as pct_of_category_units,\n        case\n            when p.avg_rating >= 4 and p.total_units_sold > 5 then 'Star Product'\n            when p.avg_rating >= 3.5 then 'Solid Performer'\n            when p.total_units_sold > 5 then 'Volume Driver'\n            else 'Niche'\n        end as product_classification\n    from products p\n    left join cat_totals ct on p.product_category = ct.product_category\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.marketing_product_popularity", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.324912Z", "completed_at": "2026-02-12T00:16:57.346328Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.351165Z", "completed_at": "2026-02-12T00:16:57.351192Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.050813913345336914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.ops_inventory_velocity", "compiled": true, "compiled_code": "-- Product inventory velocity and demand signals\nwith items as (\n    select * from ANALYTICS.STAGING.fct_order_items\n),\n\nproducts as (\n    select * from ANALYTICS.STAGING.dim_products\n),\n\nmonthly_demand as (\n    select\n        i.product_id,\n        date_trunc('month', i.order_date) as order_month,\n        sum(i.quantity) as units_sold,\n        sum(i.line_total) as revenue,\n        count(distinct i.order_id) as order_count\n    from items i\n    group by i.product_id, date_trunc('month', i.order_date)\n),\n\nfinal as (\n    select\n        md.product_id,\n        p.product_name,\n        p.product_category,\n        md.order_month,\n        md.units_sold,\n        md.revenue,\n        md.order_count,\n        p.avg_rating,\n        p.margin_pct,\n        case\n            when md.units_sold >= 10 then 'Fast Moving'\n            when md.units_sold >= 5 then 'Medium Moving'\n            else 'Slow Moving'\n        end as velocity_tier\n    from monthly_demand md\n    left join products p on md.product_id = p.product_id\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.ops_inventory_velocity", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.333949Z", "completed_at": "2026-02-12T00:16:57.350292Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.355140Z", "completed_at": "2026-02-12T00:16:57.355167Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.052136898040771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_dim_products_product_id.c8aba288d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom ANALYTICS.STAGING.dim_products\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.360665Z", "completed_at": "2026-02-12T00:16:57.386488Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.399189Z", "completed_at": "2026-02-12T00:16:57.399245Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.046671390533447266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_dim_products_product_id.ef7b2a9985", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom ANALYTICS.STAGING.dim_products\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.373414Z", "completed_at": "2026-02-12T00:16:57.393440Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.402391Z", "completed_at": "2026-02-12T00:16:57.402420Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.044782400131225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.marketing_promotion_effectiveness", "compiled": true, "compiled_code": "-- Promotion analysis (theoretical - maps promo validity to order periods)\nwith promotions as (\n    select * from ANALYTICS.STAGING.stg_promotions\n),\n\norders as (\n    select * from ANALYTICS.STAGING.fct_orders\n),\n\npromo_orders as (\n    select\n        p.promotion_id,\n        p.promotion_code,\n        p.discount_pct,\n        p.min_order_amount,\n        p.valid_from,\n        p.valid_to,\n        count(distinct o.order_id) as orders_during_promo,\n        sum(o.total_payment_amount) as revenue_during_promo,\n        avg(o.total_payment_amount) as avg_order_during_promo,\n        sum(o.coupon_amount) as coupon_usage_amount\n    from promotions p\n    left join orders o\n        on o.order_date between p.valid_from and p.valid_to\n        and o.total_payment_amount >= p.min_order_amount\n    group by\n        p.promotion_id, p.promotion_code, p.discount_pct,\n        p.min_order_amount, p.valid_from, p.valid_to\n)\n\nselect * from promo_orders", "relation_name": "ANALYTICS.STAGING.marketing_promotion_effectiveness", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.381416Z", "completed_at": "2026-02-12T00:16:57.403950Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.409619Z", "completed_at": "2026-02-12T00:16:57.409647Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05019092559814453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.ops_order_fulfillment", "compiled": true, "compiled_code": "-- Order fulfillment and status tracking\nwith orders as (\n    select * from ANALYTICS.STAGING.fct_orders\n),\n\nfinal as (\n    select\n        order_date,\n        status,\n        count(order_id) as order_count,\n        sum(total_payment_amount) as total_value,\n        avg(total_quantity) as avg_items_per_order,\n        sum(case when order_size_bucket = 'Large' then 1 else 0 end) as large_orders,\n        sum(case when order_size_bucket = 'Medium' then 1 else 0 end) as medium_orders,\n        sum(case when order_size_bucket = 'Small' then 1 else 0 end) as small_orders\n    from orders\n    group by order_date, status\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.ops_order_fulfillment", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.387877Z", "completed_at": "2026-02-12T00:16:57.408624Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.413070Z", "completed_at": "2026-02-12T00:16:57.413089Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0418093204498291, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_fct_orders_order_id.4e687af8d0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom ANALYTICS.STAGING.fct_orders\nwhere order_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.419497Z", "completed_at": "2026-02-12T00:16:57.435902Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.443891Z", "completed_at": "2026-02-12T00:16:57.443915Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03273725509643555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_fct_orders_order_id.523ddb6ce5", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom ANALYTICS.STAGING.fct_orders\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.428023Z", "completed_at": "2026-02-12T00:16:57.442571Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.453656Z", "completed_at": "2026-02-12T00:16:57.453683Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.041570186614990234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.int_customer_rfm", "compiled": true, "compiled_code": "-- RFM (Recency, Frequency, Monetary) scoring\nwith history as (\n    select * from ANALYTICS.STAGING.int_customer_order_history\n),\n\nrfm_calc as (\n    select\n        customer_id,\n        last_order_date,\n        lifetime_orders as frequency,\n        lifetime_spend as monetary,\n        -- Recency: days since last order (relative to max order date)\n        datediff('day', last_order_date, (select max(last_order_date) from history)) as recency_days\n    from history\n),\n\nfinal as (\n    select\n        customer_id,\n        recency_days,\n        frequency,\n        monetary,\n        case\n            when recency_days <= 30 then 5\n            when recency_days <= 60 then 4\n            when recency_days <= 90 then 3\n            when recency_days <= 120 then 2\n            else 1\n        end as recency_score,\n        case\n            when frequency >= 5 then 5\n            when frequency >= 4 then 4\n            when frequency >= 3 then 3\n            when frequency >= 2 then 2\n            else 1\n        end as frequency_score,\n        case\n            when monetary >= 100 then 5\n            when monetary >= 75 then 4\n            when monetary >= 50 then 3\n            when monetary >= 25 then 2\n            else 1\n        end as monetary_score\n    from rfm_calc\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.int_customer_rfm", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.437518Z", "completed_at": "2026-02-12T00:16:57.456457Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.460753Z", "completed_at": "2026-02-12T00:16:57.460779Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04277825355529785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.int_customer_segments", "compiled": true, "compiled_code": "-- Segments customers by behavior\nwith history as (\n    select * from ANALYTICS.STAGING.int_customer_order_history\n),\n\nfinal as (\n    select\n        customer_id,\n        lifetime_orders,\n        lifetime_spend,\n        avg_order_value,\n        case\n            when lifetime_orders >= 4 and lifetime_spend >= 50 then 'VIP'\n            when lifetime_orders >= 2 then 'Regular'\n            when lifetime_orders = 1 then 'New'\n            else 'Inactive'\n        end as customer_segment,\n        case\n            when avg_order_value >= 30 then 'High'\n            when avg_order_value >= 15 then 'Medium'\n            else 'Low'\n        end as spend_tier,\n        case\n            when returned_orders > 0 then true\n            else false\n        end as has_returns,\n        returned_orders * 1.0 / nullif(lifetime_orders, 0) as return_rate\n    from history\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.int_customer_segments", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.445089Z", "completed_at": "2026-02-12T00:16:57.461842Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.466456Z", "completed_at": "2026-02-12T00:16:57.466480Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.033670902252197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.int_repeat_customers", "compiled": true, "compiled_code": "-- Identifies repeat vs one-time customers\nwith history as (\n    select * from ANALYTICS.STAGING.int_customer_order_history\n),\n\nfinal as (\n    select\n        customer_id,\n        lifetime_orders,\n        lifetime_spend,\n        case\n            when lifetime_orders > 1 then true\n            else false\n        end as is_repeat_customer,\n        case\n            when lifetime_orders >= 5 then 'Champion'\n            when lifetime_orders >= 3 then 'Loyal'\n            when lifetime_orders = 2 then 'Repeat'\n            else 'One-time'\n        end as loyalty_tier,\n        completed_orders * 1.0 / nullif(lifetime_orders, 0) as completion_rate\n    from history\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.int_repeat_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.468961Z", "completed_at": "2026-02-12T00:16:57.482906Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.494308Z", "completed_at": "2026-02-12T00:16:57.494344Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03490614891052246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.finance_daily_revenue", "compiled": true, "compiled_code": "-- Daily revenue breakdown by payment method\nwith daily as (\n    select * from ANALYTICS.STAGING.int_daily_orders\n),\n\npayments as (\n    select * from ANALYTICS.STAGING.int_payment_method_analysis\n),\n\nfinal as (\n    select\n        d.order_date,\n        d.order_count,\n        d.daily_revenue,\n        d.avg_order_value,\n        d.items_sold,\n        d.unique_customers,\n        d.completed_count,\n        d.returned_count,\n        d.daily_revenue - coalesce(lag(d.daily_revenue) over (order by d.order_date), 0) as revenue_change\n    from daily d\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.finance_daily_revenue", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.476612Z", "completed_at": "2026-02-12T00:16:57.492952Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.497520Z", "completed_at": "2026-02-12T00:16:57.497549Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.03522205352783203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.int_monthly_orders", "compiled": true, "compiled_code": "-- Monthly aggregation of daily metrics\nwith daily as (\n    select * from ANALYTICS.STAGING.int_daily_orders\n),\n\nfinal as (\n    select\n        date_trunc('month', order_date) as order_month,\n        sum(order_count) as order_count,\n        sum(daily_revenue) as monthly_revenue,\n        avg(avg_order_value) as avg_order_value,\n        sum(items_sold) as items_sold,\n        sum(unique_customers) as customer_orders,\n        sum(completed_count) as completed_count,\n        sum(returned_count) as returned_count,\n        sum(returned_count) * 1.0 / nullif(sum(order_count), 0) as return_rate\n    from daily\n    group by date_trunc('month', order_date)\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.int_monthly_orders", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.485930Z", "completed_at": "2026-02-12T00:16:57.500620Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.513353Z", "completed_at": "2026-02-12T00:16:57.513395Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03945755958557129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.ops_daily_kpi_dashboard", "compiled": true, "compiled_code": "-- Daily KPI dashboard combining multiple metrics\nwith daily as (\n    select * from ANALYTICS.STAGING.int_daily_orders\n),\n\nrunning as (\n    select\n        order_date,\n        order_count,\n        daily_revenue,\n        avg_order_value,\n        items_sold,\n        unique_customers,\n        completed_count,\n        returned_count,\n        sum(daily_revenue) over (order by order_date) as cumulative_revenue,\n        sum(order_count) over (order by order_date) as cumulative_orders,\n        avg(daily_revenue) over (\n            order by order_date\n            rows between 6 preceding and current row\n        ) as revenue_7day_avg,\n        avg(order_count) over (\n            order by order_date\n            rows between 6 preceding and current row\n        ) as orders_7day_avg\n    from daily\n)\n\nselect * from running", "relation_name": "ANALYTICS.STAGING.ops_daily_kpi_dashboard", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.501273Z", "completed_at": "2026-02-12T00:16:57.518178Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.528891Z", "completed_at": "2026-02-12T00:16:57.528939Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.045232295989990234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.dim_customers", "compiled": true, "compiled_code": "-- Core customer dimension with all attributes\nwith customers as (\n    select * from ANALYTICS.STAGING.stg_customers\n),\n\nsegments as (\n    select * from ANALYTICS.STAGING.int_customer_segments\n),\n\nrfm as (\n    select * from ANALYTICS.STAGING.int_customer_rfm\n),\n\naddresses as (\n    select * from ANALYTICS.STAGING.int_customer_addresses\n),\n\nhistory as (\n    select * from ANALYTICS.STAGING.int_customer_order_history\n),\n\nfinal as (\n    select\n        c.customer_id,\n        c.first_name,\n        c.last_name,\n        c.first_name || ' ' || c.last_name as full_name,\n        a.city,\n        a.state,\n        a.zip_code,\n        s.customer_segment,\n        s.spend_tier,\n        s.has_returns,\n        s.return_rate,\n        r.recency_score,\n        r.frequency_score,\n        r.monetary_score,\n        r.recency_score + r.frequency_score + r.monetary_score as rfm_total_score,\n        h.lifetime_orders,\n        h.completed_orders,\n        h.returned_orders,\n        h.first_order_date,\n        h.last_order_date,\n        h.lifetime_spend,\n        h.avg_order_value,\n        h.lifetime_items_purchased\n    from customers c\n    left join segments s on c.customer_id = s.customer_id\n    left join rfm r on c.customer_id = r.customer_id\n    left join addresses a on c.customer_id = a.customer_id\n    left join history h on c.customer_id = h.customer_id\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.dim_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.519568Z", "completed_at": "2026-02-12T00:16:57.536977Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.540961Z", "completed_at": "2026-02-12T00:16:57.541006Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.030791282653808594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.int_state_demographics", "compiled": true, "compiled_code": "-- Customer count and order metrics by state\nwith addresses as (\n    select * from ANALYTICS.STAGING.int_customer_addresses\n),\n\nsegments as (\n    select * from ANALYTICS.STAGING.int_customer_segments\n),\n\nhistory as (\n    select * from ANALYTICS.STAGING.int_customer_order_history\n),\n\nfinal as (\n    select\n        a.state,\n        a.city,\n        count(distinct a.customer_id) as customer_count,\n        sum(h.lifetime_orders) as total_orders,\n        sum(h.lifetime_spend) as total_revenue,\n        avg(h.lifetime_spend) as avg_customer_spend,\n        sum(case when s.customer_segment = 'VIP' then 1 else 0 end) as vip_customers,\n        sum(case when s.customer_segment = 'New' then 1 else 0 end) as new_customers\n    from addresses a\n    left join segments s on a.customer_id = s.customer_id\n    left join history h on a.customer_id = h.customer_id\n    group by a.state, a.city\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.int_state_demographics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.531057Z", "completed_at": "2026-02-12T00:16:57.549442Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.554176Z", "completed_at": "2026-02-12T00:16:57.554211Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.037191152572631836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.finance_monthly_summary", "compiled": true, "compiled_code": "-- Monthly P&L style summary\nwith monthly as (\n    select * from ANALYTICS.STAGING.int_monthly_orders\n),\n\nline_items as (\n    select\n        date_trunc('month', order_date) as order_month,\n        sum(line_profit) as total_profit,\n        sum(line_cost) as total_cogs\n    from ANALYTICS.STAGING.fct_order_items\n    group by date_trunc('month', order_date)\n),\n\nfinal as (\n    select\n        m.order_month,\n        m.order_count,\n        m.monthly_revenue as gross_revenue,\n        li.total_cogs,\n        li.total_profit as gross_profit,\n        case when m.monthly_revenue > 0\n            then li.total_profit / m.monthly_revenue * 100\n            else 0\n        end as gross_margin_pct,\n        m.avg_order_value,\n        m.items_sold,\n        m.completed_count,\n        m.returned_count,\n        m.return_rate\n    from monthly m\n    left join line_items li on m.order_month = li.order_month\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.finance_monthly_summary", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.571355Z", "completed_at": "2026-02-12T00:16:57.588339Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.592974Z", "completed_at": "2026-02-12T00:16:57.593023Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04147052764892578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.marketing_channel_attribution", "compiled": true, "compiled_code": "-- Payment channel attribution analysis for marketing\nwith orders as (\n    select * from ANALYTICS.STAGING.fct_orders\n),\n\ncustomers as (\n    select * from ANALYTICS.STAGING.dim_customers\n),\n\nfinal as (\n    select\n        c.customer_segment,\n        c.spend_tier,\n        case\n            when o.credit_card_amount > 0 and o.coupon_amount > 0 then 'Mixed (CC+Coupon)'\n            when o.credit_card_amount > 0 then 'Credit Card Only'\n            when o.coupon_amount > 0 then 'Coupon Only'\n            when o.bank_transfer_amount > 0 then 'Bank Transfer'\n            when o.gift_card_amount > 0 then 'Gift Card'\n            else 'Unknown'\n        end as primary_payment_channel,\n        count(distinct o.order_id) as order_count,\n        sum(o.total_payment_amount) as total_revenue,\n        avg(o.total_payment_amount) as avg_order_value,\n        count(distinct o.customer_id) as unique_customers\n    from orders o\n    left join customers c on o.customer_id = c.customer_id\n    group by\n        c.customer_segment,\n        c.spend_tier,\n        case\n            when o.credit_card_amount > 0 and o.coupon_amount > 0 then 'Mixed (CC+Coupon)'\n            when o.credit_card_amount > 0 then 'Credit Card Only'\n            when o.coupon_amount > 0 then 'Coupon Only'\n            when o.bank_transfer_amount > 0 then 'Bank Transfer'\n            when o.gift_card_amount > 0 then 'Gift Card'\n            else 'Unknown'\n        end\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.marketing_channel_attribution", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.563193Z", "completed_at": "2026-02-12T00:16:57.589952Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.595738Z", "completed_at": "2026-02-12T00:16:57.595761Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04548048973083496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.finance_customer_revenue_bands", "compiled": true, "compiled_code": "-- Customer revenue band distribution for finance planning\nwith customers as (\n    select * from ANALYTICS.STAGING.dim_customers\n),\n\nfinal as (\n    select\n        case\n            when lifetime_spend >= 100 then '$100+'\n            when lifetime_spend >= 75 then '$75-99'\n            when lifetime_spend >= 50 then '$50-74'\n            when lifetime_spend >= 25 then '$25-49'\n            when lifetime_spend > 0 then '$1-24'\n            else '$0'\n        end as revenue_band,\n        count(customer_id) as customer_count,\n        sum(lifetime_spend) as band_total_revenue,\n        avg(lifetime_spend) as avg_spend,\n        avg(lifetime_orders) as avg_orders,\n        min(first_order_date) as earliest_customer,\n        max(last_order_date) as latest_activity\n    from customers\n    group by\n        case\n            when lifetime_spend >= 100 then '$100+'\n            when lifetime_spend >= 75 then '$75-99'\n            when lifetime_spend >= 50 then '$50-74'\n            when lifetime_spend >= 25 then '$25-49'\n            when lifetime_spend > 0 then '$1-24'\n            else '$0'\n        end\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.finance_customer_revenue_bands", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.578921Z", "completed_at": "2026-02-12T00:16:57.591802Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.603381Z", "completed_at": "2026-02-12T00:16:57.603408Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05061602592468262, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.marketing_customer_cohorts", "compiled": true, "compiled_code": "-- Customer cohort analysis by first order month\nwith customers as (\n    select * from ANALYTICS.STAGING.dim_customers\n),\n\norders as (\n    select * from ANALYTICS.STAGING.fct_orders\n),\n\ncohort_base as (\n    select\n        c.customer_id,\n        date_trunc('month', c.first_order_date) as cohort_month,\n        o.order_date,\n        o.total_payment_amount,\n        -- months since first order\n        datediff('month', c.first_order_date, o.order_date) as months_since_first\n    from customers c\n    inner join orders o on c.customer_id = o.customer_id\n),\n\nfinal as (\n    select\n        cohort_month,\n        months_since_first as period_number,\n        count(distinct customer_id) as active_customers,\n        count(*) as order_count,\n        sum(total_payment_amount) as cohort_revenue,\n        avg(total_payment_amount) as avg_order_value\n    from cohort_base\n    group by cohort_month, months_since_first\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.marketing_customer_cohorts", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.597204Z", "completed_at": "2026-02-12T00:16:57.615698Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.620675Z", "completed_at": "2026-02-12T00:16:57.620700Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.03525376319885254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.marketing_segment_performance", "compiled": true, "compiled_code": "-- Performance metrics by customer segment\nwith customers as (\n    select * from ANALYTICS.STAGING.dim_customers\n),\n\nfinal as (\n    select\n        customer_segment,\n        spend_tier,\n        count(customer_id) as customer_count,\n        avg(lifetime_orders) as avg_orders,\n        avg(lifetime_spend) as avg_spend,\n        sum(lifetime_spend) as total_revenue,\n        avg(avg_order_value) as avg_aov,\n        sum(case when has_returns then 1 else 0 end) as customers_with_returns,\n        avg(return_rate) as avg_return_rate,\n        avg(rfm_total_score) as avg_rfm_score\n    from customers\n    group by customer_segment, spend_tier\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.marketing_segment_performance", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.627950Z", "completed_at": "2026-02-12T00:16:57.647962Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.652996Z", "completed_at": "2026-02-12T00:16:57.653143Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.043297767639160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.ops_customer_lifetime_value", "compiled": true, "compiled_code": "-- Customer LTV calculations\nwith customers as (\n    select * from ANALYTICS.STAGING.dim_customers\n),\n\norders as (\n    select * from ANALYTICS.STAGING.fct_orders\n),\n\norder_gaps as (\n    select\n        customer_id,\n        order_date,\n        lag(order_date) over (partition by customer_id order by order_date) as prev_order_date,\n        datediff('day', lag(order_date) over (partition by customer_id order by order_date), order_date) as days_between_orders\n    from orders\n),\n\navg_gaps as (\n    select\n        customer_id,\n        avg(days_between_orders) as avg_days_between_orders,\n        count(*) as repeat_purchases\n    from order_gaps\n    where days_between_orders is not null\n    group by customer_id\n),\n\nfinal as (\n    select\n        c.customer_id,\n        c.full_name,\n        c.customer_segment,\n        c.spend_tier,\n        c.state,\n        c.lifetime_orders,\n        c.lifetime_spend,\n        c.avg_order_value,\n        c.rfm_total_score,\n        ag.avg_days_between_orders,\n        ag.repeat_purchases,\n        case\n            when ag.avg_days_between_orders > 0 then 365.0 / ag.avg_days_between_orders\n            else 1\n        end as estimated_annual_orders,\n        c.avg_order_value * case\n            when ag.avg_days_between_orders > 0 then 365.0 / ag.avg_days_between_orders\n            else 1\n        end as estimated_annual_value\n    from customers c\n    left join avg_gaps ag on c.customer_id = ag.customer_id\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.ops_customer_lifetime_value", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.632681Z", "completed_at": "2026-02-12T00:16:57.649392Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.654819Z", "completed_at": "2026-02-12T00:16:57.654854Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03666377067565918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.ops_return_analysis", "compiled": true, "compiled_code": "-- Detailed return analysis\nwith orders as (\n    select * from ANALYTICS.STAGING.fct_orders\n),\n\ncustomers as (\n    select * from ANALYTICS.STAGING.dim_customers\n),\n\nreturned as (\n    select\n        o.order_id,\n        o.customer_id,\n        o.customer_name,\n        o.order_date,\n        o.status,\n        o.total_payment_amount,\n        o.total_items,\n        c.customer_segment,\n        c.lifetime_orders,\n        c.lifetime_spend\n    from orders o\n    left join customers c on o.customer_id = c.customer_id\n    where o.is_returned = true\n),\n\nfinal as (\n    select\n        date_trunc('month', order_date) as return_month,\n        count(order_id) as return_count,\n        sum(total_payment_amount) as returned_value,\n        avg(total_payment_amount) as avg_return_value,\n        count(distinct customer_id) as customers_returning,\n        sum(case when customer_segment = 'VIP' then 1 else 0 end) as vip_returns,\n        sum(case when lifetime_orders = 1 then 1 else 0 end) as first_order_returns\n    from returned\n    group by date_trunc('month', order_date)\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.ops_return_analysis", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.639013Z", "completed_at": "2026-02-12T00:16:57.652062Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.663758Z", "completed_at": "2026-02-12T00:16:57.663781Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04422187805175781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom ANALYTICS.STAGING.dim_customers\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.656253Z", "completed_at": "2026-02-12T00:16:57.671691Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.678843Z", "completed_at": "2026-02-12T00:16:57.678868Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.033095598220825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom ANALYTICS.STAGING.dim_customers\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-12T00:16:57.672866Z", "completed_at": "2026-02-12T00:16:57.680634Z"}, {"name": "execute", "started_at": "2026-02-12T00:16:57.681410Z", "completed_at": "2026-02-12T00:16:57.681430Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013644933700561523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.marketing_geo_performance", "compiled": true, "compiled_code": "-- Geographic performance for marketing targeting\nwith demographics as (\n    select * from ANALYTICS.STAGING.int_state_demographics\n),\n\nfinal as (\n    select\n        state,\n        city,\n        customer_count,\n        total_orders,\n        total_revenue,\n        avg_customer_spend,\n        vip_customers,\n        new_customers,\n        case when customer_count > 0\n            then vip_customers * 1.0 / customer_count * 100\n            else 0\n        end as vip_pct,\n        case when customer_count > 0\n            then total_revenue / customer_count\n            else 0\n        end as revenue_per_customer\n    from demographics\n)\n\nselect * from final", "relation_name": "ANALYTICS.STAGING.marketing_geo_performance", "batch_results": null}], "elapsed_time": 6.264372825622559, "args": {"project_dir": "/home/anant/dataPortal_demo/dbt", "show_all_deprecations": false, "upload_to_artifacts_ingest_api": false, "static": false, "require_batched_execution_for_custom_microbatch_strategy": false, "skip_nodes_if_on_run_start_fails": false, "use_fast_test_edges": false, "empty_catalog": false, "select": [], "compile": true, "log_level_file": "debug", "require_yaml_configuration_for_mf_time_spines": false, "use_colors_file": true, "state_modified_compare_more_unrendered_values": false, "require_generic_test_arguments_property": true, "cache_selected_only": false, "log_level": "info", "partial_parse_file_diff": true, "macro_debugging": false, "favor_state": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "printer_width": 80, "require_unique_project_resource_names": false, "quiet": false, "source_freshness_run_project_hooks": true, "require_all_warnings_handled_by_warn_error": false, "send_anonymous_usage_stats": true, "log_path": "/home/anant/dataPortal_demo/dbt/logs", "show_resource_report": false, "log_file_max_bytes": 10485760, "state_modified_compare_vars": false, "strict_mode": false, "vars": {}, "require_explicit_package_overrides_for_builtin_materializations": true, "defer": false, "require_resource_names_without_spaces": true, "validate_macro_args": false, "static_parser": true, "write_json": true, "print": true, "invocation_command": "dbt docs generate --profiles-dir .", "introspect": true, "version_check": true, "log_format": "default", "use_colors": true, "populate_cache": true, "require_nested_cumulative_type_params": false, "log_format_file": "debug", "indirect_selection": "eager", "which": "generate", "partial_parse": true, "require_ref_searches_node_package_before_root": false, "exclude": [], "profiles_dir": "."}}